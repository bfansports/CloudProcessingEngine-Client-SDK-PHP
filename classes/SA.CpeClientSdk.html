<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="utf-8">
<title>Cloud Processing Engine Client SDK PHP » \SA\CpeClientSdk</title>
<meta name="author" content="Mike van Riel">
<meta name="description" content="">
<link href="../css/template.css" rel="stylesheet" media="all">
<script src="../js/jquery-1.7.1.min.js" type="text/javascript"></script><script src="../js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script><script src="../js/jquery.mousewheel.min.js" type="text/javascript"></script><script src="../js/bootstrap.js" type="text/javascript"></script><script src="../js/template.js" type="text/javascript"></script><script src="../js/prettify/prettify.min.js" type="text/javascript"></script><link rel="shortcut icon" href="../img/favicon.ico">
<link rel="apple-touch-icon" href="../img/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/apple-touch-icon-114x114.png">
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner"><div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="../index.html">Cloud Processing Engine Client SDK PHP</a><div class="nav-collapse"><ul class="nav">
<li class="dropdown">
<a href="#api" class="dropdown-toggle" data-toggle="dropdown">
                                    API Documentation <b class="caret"></b></a><ul class="dropdown-menu">
<li><a>Packages</a></li>
<li><a href="../packages/Default.html"><i class="icon-folder-open"></i> Default</a></li>
</ul>
</li>
<li class="dropdown" id="charts-menu">
<a href="#charts" class="dropdown-toggle" data-toggle="dropdown">
                                    Charts <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="../graph_class.html"><i class="icon-list-alt"></i> Class hierarchy diagram</a></li></ul>
</li>
<li class="dropdown" id="reports-menu">
<a href="#reports" class="dropdown-toggle" data-toggle="dropdown">
                                    Reports <b class="caret"></b></a><ul class="dropdown-menu">
<li><a href="../errors.html"><i class="icon-remove-sign"></i> Errors 
                <span class="label label-info">1</span></a></li>
<li><a href="../markers.html"><i class="icon-map-marker"></i> Markers 
                <ul></ul></a></li>
<li><a href="../deprecated.html"><i class="icon-stop"></i> Deprecated elements 
                <span class="label label-info">0</span></a></li>
</ul>
</li>
</ul></div>
</div></div>
<div class="go_to_top"><a href="#___" style="color: inherit">Back to top  <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
<noscript><div class="alert alert-warning">
                            Javascript is disabled; several features are only available
                            if Javascript is enabled.
                        </div></noscript>
<div class="row">
<div class="span4">
<div xmlns:php="http://php.net/xsl" class="btn-toolbar">
<div class="btn-group visibility" data-toggle="buttons-checkbox">
<button class="btn public active" title="Show public elements">Public</button><button class="btn protected" title="Show protected elements">Protected</button><button class="btn private" title="Show private elements">Private</button><button class="btn inherited active" title="Show inherited elements">Inherited</button>
</div>
<div class="btn-group view pull-right" data-toggle="buttons-radio">
<button class="btn details" title="Show descriptions and method names"><i class="icon-list"></i></button><button class="btn simple" title="Show only method names"><i class="icon-align-justify"></i></button>
</div>
</div>
<ul xmlns:php="http://php.net/xsl" class="side-nav nav nav-list">
<li class="nav-header">
<i title="Methods" class="icon-custom icon-method"></i> Methods
                    <ul>
<li class="method public "><a href="#method___construct" title="__construct() :: Constructor for the CpeClientSdk class."><span class="description">Constructor for the CpeClientSdk class.</span><pre>__construct()</pre></a></li>
<li class="method public "><a href="#method_delete_message" title="delete_message() :: Delete the provided message from the SQS queue"><span class="description">Delete the provided message from the SQS queue</span><pre>delete_message()</pre></a></li>
<li class="method public "><a href="#method_receive_message" title="receive_message() :: Poll for incoming SQS messages using this method."><span class="description">Poll for incoming SQS messages using this method.</span><pre>receive_message()</pre></a></li>
<li class="method public "><a href="#method_start_job" title="start_job() :: Send a `start_job` command to CPE"><span class="description">Send a `start_job` command to CPE</span><pre>start_job()</pre></a></li>
</ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="method private "><a href="#method_craft_new_msg" title="craft_new_msg() :: Craft the object to be sent out to SQS"><span class="description">Craft the object to be sent out to SQS</span><pre>craft_new_msg()</pre></a></li>
<li class="method private "><a href="#method_log_out" title="log_out() :: Simple logout function"><span class="description">Simple logout function</span><pre>log_out()</pre></a></li>
<li class="method private "><a href="#method_validate_client" title="validate_client() :: Validate Client object structure"><span class="description">Validate Client object structure</span><pre>validate_client()</pre></a></li>
</ul>
</li>
<li class="nav-header">
<i title="Properties" class="icon-custom icon-property"></i> Properties
                    <ul></ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="property private "><a href="#property_aws" title="$aws() :: AWS SDK handler *"><span class="description"></span><pre>$aws</pre></a></li>
<li class="property private "><a href="#property_debug" title="$debug() :: Debug flag *"><span class="description"></span><pre>$debug</pre></a></li>
<li class="property private "><a href="#property_region" title="$region() :: AWS region for SQS *"><span class="description"></span><pre>$region</pre></a></li>
<li class="property private "><a href="#property_sqs" title="$sqs() :: AWS SQS handler *"><span class="description"></span><pre>$sqs</pre></a></li>
<li class="property private "><a href="#property_sts" title="$sts() :: AWS STS handler."><span class="description"></span><pre>$sts</pre></a></li>
</ul>
</li>
<li class="nav-header">
<i title="Constants" class="icon-custom icon-constant"></i> Constants
                    <ul><li class="constant  "><a href="#constant_START_JOB" title="START_JOB() :: "><span class="description">START_JOB</span><pre>START_JOB</pre></a></li></ul>
</li>
</ul>
</div>
<div class="span8">
<a xmlns:php="http://php.net/xsl" id="\SA\CpeClientSdk"></a><ul xmlns:php="http://php.net/xsl" class="breadcrumb">
<li>
<a href="../index.html"><i title="Classes" class="icon-custom icon-class"></i></a><span class="divider">\</span>
</li>
<li><a href="../namespaces/SA.html">SA</a></li>
<li class="active">
<span class="divider">\</span><a href="../classes/SA.CpeClientSdk.html">CpeClientSdk</a>
</li>
</ul>
<div xmlns:php="http://php.net/xsl" class="element class">
<p class="short_description">The CpeClientSDK is to be used by client applications of the
Client Processing Engine (CPE) project.</p>
<div class="details">
<div class="long_description"><p>See: <a href="https://github.com/sportarchive/CloudProcessingEngine">https://github.com/sportarchive/CloudProcessingEngine</a></p>
<p>You must use this SDK in your PHP client application if you want to communicate
with the CPE stack through AWS SQS.</p>
<p><strong>It allows you to:</strong></p>
<ul>
<li>Poll SQS messages coming from the CPE stack</li>
<li>Send correctly crafted messages to the CPE Stack (commands such as <code>start_job</code>).</li>
</ul>
<p><strong>Install:</strong>
To install this SDK, just user composer.</p>
<p>See: <a href="https://packagist.org/packages/sportarchive/cloud-processing-engine-client-sdk-php">https://packagist.org/packages/sportarchive/cloud-processing-engine-client-sdk-php</a></p></div>
<table class="table table-bordered"><tr>
<th>package</th>
<td><a href="../packages/Default.html">Default</a></td>
</tr></table>
<h3>
<i title="Methods" class="icon-custom icon-method"></i> Methods</h3>
<a id="method___construct"></a><div class="element clickable method public method___construct " data-toggle="collapse" data-target=".method___construct .collapse" title="public">
<h2>Constructor for the CpeClientSdk class.</h2>
<pre>__construct(string $key<code> = false</code>, string $secret<code> = false</code>, string $region<code> = false</code>, string $debug<code> = false</code>) : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"><p>By default the SDK will look for AWS credentials in your environment variables.
You can pass on your AWS credentials to the constructor too.
You must specify the region your SQS queues are setup.</p></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$key</h4>
<code>string</code><p>AWS key</p></div>
<div class="subelement argument">
<h4>$secret</h4>
<code>string</code><p>AWS secret</p></div>
<div class="subelement argument">
<h4>$region</h4>
<code>string</code><p>AWS region</p></div>
<div class="subelement argument">
<h4>$debug</h4>
<code>string</code><p>Debug flag</p></div>
</div></div>
</div>
<a id="method_delete_message"></a><div class="element clickable method public method_delete_message " data-toggle="collapse" data-target=".method_delete_message .collapse" title="public">
<h2>Delete the provided message from the SQS queue</h2>
<pre>delete_message(string|object $client, object $msg) : true</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"><p>Call this method from your client application after receiving a message
You must clean the SQS yourself, or you will keep processing the same messages</p></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$client</h4>
<code>string</code><code>object</code><p>JSON string or PHP Object created using json_decode. This contains your client SQS configuration which list your application <code>input</code> and <code>output</code> queues.</p></div>
<div class="subelement argument">
<h4>$msg</h4>
<code>object</code><p>The message oject you received from `receive_message``</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>true</code>Can throw an Exeception if it fails. Use try catch.</div>
</div></div>
</div>
<a id="method_receive_message"></a><div class="element clickable method public method_receive_message " data-toggle="collapse" data-target=".method_receive_message .collapse" title="public">
<h2>Poll for incoming SQS messages using this method.</h2>
<pre>receive_message(string|object $client, integer $timeout) : object | false</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"><p>Call this method in a loop in your client application.
If a new message is polled, it is returned to the caller.</p></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$client</h4>
<code>string</code><code>object</code><p>JSON string or PHP Object created using json_decode. This contains your client SQS configuration which list your application <code>input</code> and <code>output</code> queues.</p></div>
<div class="subelement argument">
<h4>$timeout</h4>
<code>integer</code><p>Timeout value for the polling. After $timeout, the poller will return.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>object</code><code>false</code>The SQS message or false if nothing. Can throw an Exception. Use try catch.</div>
</div></div>
</div>
<a id="method_start_job"></a><div class="element clickable method public method_start_job " data-toggle="collapse" data-target=".method_start_job .collapse" title="public">
<h2>Send a `start_job` command to CPE</h2>
<pre>start_job(string|object $client, object|string $input, string|null $jobId<code> = null</code>) : string</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"><p>Call this method from your client application to start a new job.
You can pass an object or a JSON string as input payload.
You can also specify your own jobId, or it will generate it for you.</p></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$client</h4>
<code>string</code><code>object</code><p>JSON string or PHP Object created using json_decode. This contains your client SQS configuration which list your application <code>input</code> and <code>output</code> queues.</p></div>
<div class="subelement argument">
<h4>$input</h4>
<code>object</code><code>string</code><p>The data payload to be sent out to CPE. This will be used
   as input for your workflow.</p></div>
<div class="subelement argument">
<h4>$jobId</h4>
<code>string</code><code>null</code><p>JobID for your new job. Will be generated for you if not provided.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>string</code>Return the JobIb for the job. Can throw execeptions if it fails. Use try catch.</div>
</div></div>
</div>
<a id="method_craft_new_msg"></a><div class="element clickable method private method_craft_new_msg " data-toggle="collapse" data-target=".method_craft_new_msg .collapse" title="private">
<h2>Craft the object to be sent out to SQS</h2>
<pre>craft_new_msg(string $type, string $jobId, $client, string $data) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$type</h4>
<code>string</code><p>Type of CPE command you send</p></div>
<div class="subelement argument">
<h4>$jobId</h4>
<code>string</code><p>Job ID for the command</p></div>
<div class="subelement argument"><h4>$client</h4></div>
<div class="subelement argument">
<h4>$data</h4>
<code>string</code><p>Data payload to be sent out</p></div>
</div></div>
</div>
<a id="method_log_out"></a><div class="element clickable method private method_log_out " data-toggle="collapse" data-target=".method_log_out .collapse" title="private">
<h2>Simple logout function</h2>
<pre>log_out(string $type, string $message) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$type</h4>
<code>string</code><p>Type of log message (error, debug, etc)</p></div>
<div class="subelement argument">
<h4>$message</h4>
<code>string</code><p>Message to be printed out</p></div>
</div></div>
</div>
<a id="method_validate_client"></a><div class="element clickable method private method_validate_client " data-toggle="collapse" data-target=".method_validate_client .collapse" title="private">
<h2>Validate Client object structure</h2>
<pre>validate_client(string|object $client) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$client</h4>
<code>string</code><code>object</code><p>JSON string or PHP Object created using json_decode. This contains your client SQS configuration which list your application <code>input</code> and <code>output</code> queues.</p></div>
</div></div>
</div>
<h3>
<i title="Properties" class="icon-custom icon-property"></i> Properties</h3>
<a id="property_aws"> </a><div class="element clickable property private property_aws" data-toggle="collapse" data-target=".property_aws .collapse" title="private">
<h2>AWS SDK handler *</h2>
<pre>$aws </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_debug"> </a><div class="element clickable property private property_debug" data-toggle="collapse" data-target=".property_debug .collapse" title="private">
<h2>Debug flag *</h2>
<pre>$debug </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_region"> </a><div class="element clickable property private property_region" data-toggle="collapse" data-target=".property_region .collapse" title="private">
<h2>AWS region for SQS *</h2>
<pre>$region </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_sqs"> </a><div class="element clickable property private property_sqs" data-toggle="collapse" data-target=".property_sqs .collapse" title="private">
<h2>AWS SQS handler *</h2>
<pre>$sqs </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_sts"> </a><div class="element clickable property private property_sts" data-toggle="collapse" data-target=".property_sts .collapse" title="private">
<h2>AWS STS handler.</h2>
<pre>$sts </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"><p>You can use AWS roles with your EC2 instance instead of passing AWS credentials.</p></div></div></div>
</div>
<h3>
<i title="Constants" class="icon-custom icon-constant"></i> Constants</h3>
<a id="constant_START_JOB"> </a><div class="element clickable constant  constant_START_JOB" data-toggle="collapse" data-target=".constant_START_JOB .collapse" title="">
<h2>START_JOB</h2>
<pre>START_JOB = "START_JOB" </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="row"><footer class="span12">
            Template is built using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap 2</a> and icons provided by <a href="http://glyphicons.com/">Glyphicons</a>.<br>
            Documentation is powered by <a href="http://www.phpdoc.org/">phpDocumentor 2.8.5</a> and<br>
            generated on 2015-11-05T01:19:04Z.<br></footer></div>
</div>
</body>
</html>
